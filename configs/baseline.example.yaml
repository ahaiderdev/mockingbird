# Low Cardinality Baseline Configuration
# This configuration provides a simple baseline with low cardinality
# for initial testing and validation.
#
# SETUP INSTRUCTIONS:
# 1. Copy this file to baseline.yaml: cp baseline.example.yaml baseline.yaml
# 2. Update the OTEL endpoint to match your collector address
# 3. Adjust prefixes if needed to avoid metric name conflicts

global:
  tick_interval_s: 1          # Generate metrics every second
  seed: 42                    # Random seed for reproducibility
  log_level: INFO             # DEBUG, INFO, WARNING, ERROR
  log_format: text            # text or json
  control_api_port: 8081      # Port for control API

exporters:
  prometheus:
    enabled: true
    port: 8000                # Prometheus scrape endpoint port
    prefix: "synthetic_prom_" # Prefix for Prometheus metrics
    bind_address: "0.0.0.0"   # Bind to all interfaces
  
  otel:
    enabled: true
    endpoint: "localhost:4317"  # CHANGE THIS: Your OTEL collector endpoint
    insecure: true              # Set to false for production with TLS
    prefix: "synthetic_otel_"   # Prefix for OTEL metrics (use underscores for PromQL compatibility)
    export_interval_s: 10       # Push metrics every 10 seconds
    protocol: grpc              # grpc or http
    resource:
      service.name: synthetic-metrics-generator
      deployment.environment: dev

profiles:
  low:
    labels:
      region:
        values: ["us-east-1", "eu-west-1"]  # 2 regions
      instance:
        range: [1, 3]                        # 3 instances per region
        fmt: "i-%02d"                        # Format: i-01, i-02, i-03
    series_cap: 1000                         # Max series to prevent runaway cardinality
    sampling_strategy: first_n               # Take first N series

metrics:
  # Counter: Monotonically increasing request count
  - name: requests_total
    type: counter
    profile: low
    algorithm: poisson              # Realistic request arrivals
    base_rate: 5                    # Average 5 requests/second
    diurnal_amp: 0.2                # 20% daily variation
    labels:
      endpoint:
        values: ["/", "/login", "/search"]  # 3 endpoints
    # Total series: 2 regions × 3 instances × 3 endpoints = 18 series
  
  # Gauge: CPU usage percentage
  - name: cpu_usage
    type: gauge
    profile: low
    algorithm: random_walk          # Brownian motion
    start: 0.4                      # Start at 40% CPU
    step: 0.02                      # Max change per tick: ±2%
    clamp: [0.0, 1.0]               # Keep between 0-100%
    # Total series: 2 regions × 3 instances = 6 series
  
  # Histogram: Request latency distribution
  - name: req_latency_seconds
    type: histogram
    profile: low
    buckets: [0.025, 0.05, 0.1, 0.2, 0.4, 0.8, 1.6]  # Latency buckets in seconds
    algorithm: lognormal            # Realistic latency distribution
    mu: -2.0                        # Log mean
    sigma: 0.9                      # Log std dev
    # Total series: 2 regions × 3 instances × 8 buckets = 48 series (+ sum, count)
  
  # Summary: Payload size with quantiles
  - name: payload_size_bytes
    type: summary
    profile: low
    objectives:
      0.5: 0.01                     # p50 with 1% error
      0.9: 0.01                     # p90 with 1% error
      0.99: 0.001                   # p99 with 0.1% error
    algorithm: lognormal
    mu: 7.0                         # ~1KB average
    sigma: 1.2
    # Total series: 2 regions × 3 instances × (3 quantiles + sum + count) = 30 series

# Total series in this config: ~100 series
# Memory usage: ~150MB
# Tick duration: <10ms

